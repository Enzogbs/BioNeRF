# BioNeRF

[BioNeRF](http://www.linkAerxiv.com) (Biologically Plausible Neural Radiance Fields) extends [NeRF](http://www.matthewtancik.com/nerf) by implementing a cognitive-inspired mechanism that fuses inputs from multiple sources into a memory-like structure, thus improving the storing capacity and extracting more intrinsic and correlated information. BioNeRF also mimics a behavior observed in pyramidal cells concerning contextual information, in which the memory is provided as the context and combined with the inputs of two subsequent blocks of dense layers, one responsible for producing the volumetric densities and the other the colors used to render the novel view. The method outperformed recent approaches and achieves state-of-the-art results for synthesizing novel views of complex scenes. Here are some videos generated by this repository (pre-trained models are provided below):


![](https://github.com/Leandropassosjr/BioNeRF/blob/dev/images/gifs.gif)

This code is based on a PyTorch implementation of [NeRF](https://github.com/yenchenlin/nerf-pytorch).

## Installation

```
git clone https://github.com/Leandropassosjr/BioNeRF.git
cd BioNeRF
pip install -r requirements.txt
```

<details>
  <summary> Dependencies (click to expand) </summary>
  
  ## Dependencies
  - numpy
  - torch
  - torchvision
  - imageio
  - imageio
  - matplotlib
  - configargparse
  - tensorboard
  - tqdm
  - opencv-python
  - torchmetrics


  
The LLFF data loader requires ImageMagick.
  
</details>

## How To Run?


Download synthetic Blender and LLFF scenes from [here](https://drive.google.com/drive/folders/128yBriW1IG_3NJ5Rp7APSTZsJqdJdfc1). Place the downloaded dataset according to the following directory structure:
```
├── configs                                                                                                       
│   ├── ...                                                                                     
│                                                                                               
├── data                                                                                                                                                                                                       
│   ├── nerf_llff_data                                                                                                  
│   │   └── fern                                                                                                                             
│   │   └── flower  # downloaded llff dataset                                                                                  
│   │   └── horns   # downloaded llff dataset
|   |   └── ...
|   ├── nerf_synthetic
|   |   └── lego
|   |   └── ship    # downloaded synthetic dataset
|   |   └── ...
```





To train a 400x400 `ship` scene on BioNeRF:
```
python run_bionerf.py --config configs/ship.txt
```

After training you can find the following video at `logs/blender_paper_ship/blender_paper_ship_spiral_400000_rgb.mp4`.

![](images/ship.gif)
<img src="https://github.com/Leandropassosjr/BioNeRF/blob/dev/images/ship.gif" width="100" height="100">

---

To train BioNeRF on different datasets: 

```
python run_bionerf.py --config configs/{DATASET}.txt
```

replace `{DATASET}` with `trex` | `horns` | `flower` | `fortress` | `lego` | etc.

---

To test BioNeRF trained on different datasets: 

```
python run_bionerf.py --config configs/{DATASET}.txt --render_only --render_test --generate_samples
```

replace `{DATASET}` with `trex` | `horns` | `flower` | `fortress` | `lego` | etc.

### Pre-trained Models

You can download the pre-trained models [here](https://drive.google.com/drive/folders/1oOVRMq3EJ3q4pZcbeuoiCuh1zrdiRb85?usp=drive_link). Place the downloaded directory in `./logs` in order to test it later. See the following directory structure for an example:

```
├── logs 
│   ├── fern_test
│   ├── flower_test  # downloaded logs
│   ├── trex_test    # downloaded logs
```

## Method

[BioNeRF: Biologically-plausible NeRF for View Synthesis](http://link.com)  
 [Leandro Passos](https://orcid.org/0000-0003-3529-3109),
 [Douglas Rodrigues](xxx),
 [Danilo Jodas](zzz),
 [Kelton Pontara](xxx),
 [João Paulo Papa](https://papajpblog.wordpress.com/) <br>
 UNESP Bauru
  
<img src='https://github.com/Leandropassosjr/BioNeRF/blob/dev/images/nerf_ship.jpeg'/>
<img src='https://github.com/Leandropassosjr/BioNeRF/blob/dev/images/BioNeRF.jpeg'/>


## Citation
```
@misc{passos2024BioNeRF,
    title={BioNeRF: Biologically-plausible NeRF for View Synthesis},
    author={Passos, L.A. and Rodrigues, D. and Jodas, D.S. and Costa, K.A.P. and Papa, J.P.},
    year={2024},
    eprint={xxxx.xxxxx},
    archivePrefix={arXiv},
    primaryClass={cs.CV}
}
```

